
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Deploying with Docker Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-hints/plugin-hints.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-quizzes/quizzes.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-theme-api/theme-api.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="deployingwithdocker.html" />
    
    
    <link rel="prev" href="../images/networking.md#bridge-networks" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        <li class="header">A hacky dev-ish guide to getting started with Docker</li>
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../intro/">
            
                <a href="../intro/">
            
                    
                    What is Docker
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../intro/terminology.html">
            
                <a href="../intro/terminology.html">
            
                    
                    Software and Terminology
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="../intro/terminology.html">
            
                <a href="../intro/terminology.html#software-you-need">
            
                    
                    Software you need
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="../intro/terminology.html">
            
                <a href="../intro/terminology.html#jargon-you-need-to-know">
            
                    
                    Jargon you need to know
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../images/images.html">
            
                <a href="../images/images.html">
            
                    
                    Images in more detail
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../images/images.html">
            
                <a href="../images/images.html#base-images">
            
                    
                    Base Images
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="../images/images.html">
            
                <a href="../images/images.html#dockerfiles">
            
                    
                    Dockerfiles
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="../images/images.html">
            
                <a href="../images/images.html#docker-entrypoint.sh">
            
                    
                    Docker-EntryPoint
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../images/storage.html">
            
                <a href="../images/storage.html">
            
                    
                    Storage
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="../images/storage.html">
            
                <a href="../images/storage.html#volumes">
            
                    
                    Volumes
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="../images/storage.html">
            
                <a href="../images/storage.html#bind-mounts">
            
                    
                    Bind Mounts
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="../images/networking.html">
            
                <a href="../images/networking.html">
            
                    
                    Networking in Containers
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="../images/networking.html">
            
                <a href="../images/networking.html#bridge-networks">
            
                    
                    Bridge Networks
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2" data-path="../images/networking.md#bridge-networks">
            
                <span>
            
                    
                    Host Networks
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.3" data-path="../images/networking.md#bridge-networks">
            
                <span>
            
                    
                    Exposing Ports
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter active" data-level="1.7" data-path="deployingwithdocker.html">
            
                <a href="deployingwithdocker.html">
            
                    
                    Deploying with Docker
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.1" data-path="deployingwithdocker.html">
            
                <a href="deployingwithdocker.html#single-containers">
            
                    
                    Single Containers
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.2" data-path="deployingwithdocker.html">
            
                <a href="deployingwithdocker.html#multiple-linked-containers">
            
                    
                    Multiple containers
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.3" data-path="deployingwithdocker.html">
            
                <a href="deployingwithdocker.html#making-changes-stopping-and-starting">
            
                    
                    Stopping, starting, and making changes
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="usefulcommands.html">
            
                <a href="usefulcommands.html">
            
                    
                    Useful Commands
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="../astunhackspecifics/hackstuff.html">
            
                <a href="../astunhackspecifics/hackstuff.html">
            
                    
                    Astun Hack Specifics
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.9.1" data-path="../astunhackspecifics/hackstuff.html">
            
                <a href="../astunhackspecifics/hackstuff.html#connecting-to-your-server">
            
                    
                    Connecting to your server
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.2" data-path="../astunhackspecifics/hackstuff.html">
            
                <a href="../astunhackspecifics/hackstuff.html#getting-a-bitbucket-app-password">
            
                    
                    Getting a BitBucket App Password
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.3" data-path="../astunhackspecifics/hackstuff.html">
            
                <a href="../astunhackspecifics/hackstuff.html#setting-up-git">
            
                    
                    Setting up Git
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.4" data-path="../astunhackspecifics/hackstuff.md#setting-up-git">
            
                <span>
            
                    
                    Making changes during the hack
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.5" data-path="../astunhackspecifics/geonode.html">
            
                <a href="../astunhackspecifics/geonode.html">
            
                    
                    Geonode
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >Deploying with Docker</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="deploying-with-docker">Deploying with Docker</h1>
<h3 id="single-containers">Single containers</h3>
<p>You can deploy single containers at the command line with the <code>docker run</code> command, which is a shortcut of two other commands- <code>docker create</code> and <code>docker start</code>.</p>
<p><div class="alert alert-danger hints-alert"><div class="hints-icon"><i class="fa fa-exclamation"></i></div><div class="hints-container"><p>If you&apos;re not pulling a ready-built image from a container repository then you&apos;ll need to build the image from a Dockerfile first! See <a href="https://docs.docker.com/engine/reference/commandline/build/" target="_blank">https://docs.docker.com/engine/reference/commandline/build/</a> for more details</p>
</div></div></p>
<div class="api-method"><div class="api-method-definition"><p>The full <code>docker run</code> syntax can be found at <a href="https://docs.docker.com/engine/reference/commandline/run/" target="_blank">https://docs.docker.com/engine/reference/commandline/run/</a> but the basic syntax is as follows:</p>
</div><div class="api-method-code"><div class="api-method-example"><pre><code class="lang-bash">docker run [options] image [<span class="hljs-built_in">command</span>] [args]
</code></pre>
<p>A simple example is:</p>
<pre><code>docker run --name mycontainer debian -d
</code></pre><p>This would start a container called mycontainer, based on the debian image on dockerhub, and ask it to run in the background once it&apos;s launched.</p>
</div></div></div>

<p>Go see the full syntax at the link above, but useful things you can do with <code>docker run</code> include:</p>
<ul>
<li><code>-v /folder/on/host:/folder/in/container</code>: mount a host volume in the container</li>
<li><code>-p 8080:8081</code>: publish port 8080 on the container as port 8081 on the host</li>
<li><code>--rm</code>: automatically remove the container when it exits (useful for a container that do things like run tests)</li>
<li><code>-e ENVVAR=somestring</code>: set the environment variable ENVVAR in the container equal to somestring</li>
<li><code>--restart unless-stopped</code>: sets the container restart policy to restart, but not if explicitly stopped with &apos;docker stop&apos;</li>
</ul>
<p>Note that running <code>docker run</code> with a command overrides the <code>CMD</code> set in the docker file. </p>
<h3 id="multiple-linked-containers">Multiple Linked Containers</h3>
<p>The <code>docker run</code> command is fine for running single containers at once but it&apos;s a lot to manage and it&apos;s not easy to see at a glance what options a container was started up with. To get around that, we use <code>docker-compose</code>, which allows us to define a set of containers (otherwise known as services) in a text file written in yaml format. A <code>docker-compose.yml</code> file contains not only the instructions for <code>docker run</code>, but also allows you to define shared volumes, an internal network so that the containers can communicate with each other, and any dependencies between containers. For example if your website CMS container depends on a back-end database being up and running, you could set that as a dependency.</p>
<div class="api-method"><div class="api-method-definition"><p>The reference information for the <code>docker-compose</code> command is at <a href="https://docs.docker.com/compose/reference/overview/" target="_blank">https://docs.docker.com/compose/reference/overview/</a> and the reference for a docker-compose.yml file is at <a href="https://docs.docker.com/compose/compose-file/compose-file-v2/" target="_blank">https://docs.docker.com/compose/compose-file/compose-file-v2/</a>. The basic <code>docker-compose</code> syntax is as follows:</p>
</div><div class="api-method-code"><div class="api-method-example"><pre><code class="lang-bash">$ docker-compose <span class="hljs-_">-f</span> [arg] [options] [COMMAND] [ARGS]
</code></pre>
</div></div></div>

<p>Where:</p>
<ul>
<li><code>-f [arg]</code> is the filename for the docker-compose file (default <code>docker-compose.yml</code>). Note you can have multiple -f parameters with multiple docker-compose files, where the latter ones override the earlier ones</li>
<li><code>[COMMAND]</code> is generally <code>build</code> or <code>up</code> or <code>down</code></li>
<li><code>[args]</code> are generally <code>-d</code> for running it in the background or not</li>
</ul>
<div class="api-method"><div class="api-method-definition"><p>Given a default <code>docker-compose.yml</code> file, the simplest <code>docker-compose</code> example would be:</p>
</div><div class="api-method-code"><div class="api-method-example"><pre><code class="lang-bash">$ docker-compose up <span class="hljs-_">-d</span>
</code></pre>
</div></div></div>

<p>This would bring up the services (containers) in defined in <code>docker-compose.yml</code> and run it in the background.</p>
<div class="api-method"><div class="api-method-definition"><h3 id="making-changes-stopping-and-starting">Making changes, stopping and starting</h3>
<p>To make changes to the configuration for a container, such as a change in the <code>docker-compose.yml</code> file, you&apos;ll need to recreate the container. Simply starting and stopping it will not be enough.</p>
<p>There are various commands for starting and stopping services using <code>docker-compose</code> but they behave differently. See the reference linked to above. Since the most likely thing you will need to do is rebuild containers because you have made changes to the configuration in docker-compose.yml, then the best approach is to use <code>down</code> and <code>up</code>, or just <code>up --forcerecreate</code>:</p>
</div><div class="api-method-code"><div class="api-method-example"><pre><code class="lang-bash">$ docker-compose down
$ docker-compose <span class="hljs-_">-f</span> docker-compose.yml up <span class="hljs-_">-d</span>
$ docker-compose <span class="hljs-_">-f</span> docker-compose.yml up <span class="hljs-_">-d</span> --force-recreate
</code></pre>
</div></div></div>




















                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            

        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Deploying with Docker","level":"1.7","depth":1,"next":{"title":"Single Containers","level":"1.7.1","depth":2,"anchor":"#single-containers","path":"deployment/deployingwithdocker.md","ref":"./deployment/deployingwithdocker.md#single-containers","articles":[]},"previous":{"title":"Exposing Ports","level":"1.6.3","depth":2,"anchor":"#exposing-ports","path":"images/networking.md#bridge-networks","ref":"./images/networking.md#bridge-networks#exposing-ports","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":["hints","theme-api","quizzes","livereload"],"pluginsConfig":{"livereload":{},"search":{},"hints":{"danger":"fa fa-exclamation","info":"fa fa-info-circle","tip":"fa fa-mortar-board","working":"fa fa-wrench"},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"fontsettings":{"theme":"white","family":"sans","size":2},"quizzes":{},"highlight":{},"theme-api":{"languages":[],"split":true,"theme":"dark"},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"deployment/deployingwithdocker.md","mtime":"2020-12-19T18:35:40.132Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2020-12-19T17:37:03.334Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-quizzes/quizzes.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-livereload/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-theme-api/theme-api.js"></script>
        
    

    </body>
</html>

